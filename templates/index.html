{% extends "layout.html" %}

{% block main %}

<header class="main-header">
    <nav>
        <img class="logo" src="../static/Images/Movie Notes-logo/Movie Notes (4).png" alt="">

        <ul class="nav-list">
            <li class="nav-user-info">
                <a href="/user_profile" class="dashboard-user-profile">
                    <div class="login-user-profile">
                        <div class="login-user-profile-pic">
                            <img src="{{user_profile['profile_pic']}}" alt="user profile picture" class="login-img" >
                        </div>
                        <div class="login-user-profile-info">
                            <p class="user-name">{{user_profile['user_name']}}</p> 
                        </div>

                    </div>
                    
                </a>
            </li>
            <li class="nav-logout-btn desktop-logout"><a href="/logout">Log out</a></li>
        </ul>
        <div class="mobile-display-nav">
            <a href="/" class="mobile-home-icon-link"><img src="../static/Images/Icons/home.png" alt="icon for a house" class="home-icon-mobile-display"></a>
            <a href="{{ url_for('search_page')}}" id="index-search" class="search-link mobile-search-link"><img src="../static/Images/Icons/search (2).png" alt="" srcset="" class="search-mobile-icon"></a>
            <a href="#" class="mobile-menu-btn" onclick="showMobileMenu()" id="mobile-menu-btn"><img src="../static/Images/Icons/menu.png" alt="menu icon" class="menu-icon"></a>
            
        </div>
        
    </nav>
    <ul class="mobile-menu" id="mobile-menu">
        <li class="close-mobile-menu" onclick="closeMobileMenu()"><a href=# class="close-mobile-menu-link"><img src="../static/Images/Icons/close.png" alt="icon of an x to symbolise close"></a></li>
        {% for dict_item in sections %}
            {% if dict_item != "Home" %}
            <li class="dashboard-menu-li">
            <a href="{{ sections[dict_item] }}" class="dashboard-menu-link"> 
                <span class="dashboard-icon">
                    {% if dict_item == "Watched" %}
                        <img src="../static/Images/Icons/video.png" alt="video icon">
                    {% elif dict_item == "Home" %}   
                        <img src="../static/Images/Icons/home.png" alt="house icon"> 
                    {% elif dict_item == "Favourites" %}
                        <img src="../static/Images/Icons/heart.png" alt="heart shape icon">  
                    {% elif dict_item == "Currently Watching" %}
                        <img src="../static/Images/Icons/cinema.png" alt="icon for people watching movie in cinema">  
                    {% elif dict_item == "Watchlist" %}
                        <img src="../static/Images/Icons/movie.png" alt="dashboard-icon"> 
                    {% elif dict_item == "Recommendations" %}
                        <img src="../static/Images/Icons/feedback.png" alt="dashboard-icon">  
                    {% elif dict_item == "Movie Buddies" %}
                        <img src="../static/Images/Icons/happy.png" alt="dashboard-icon">  
                    {% endif %}                                              
                </span>
                {{ dict_item }}
            </a>
        </li>
        {%endif%}
    {% endfor %}
    <li class="nav-logout-btn mobile-logout"><a href="/logout">Log out</a></li>
                        
</ul>
    
    
</header>

<div class="user-dashboard-container">
    <div class="user-menu">
       
        <a href="{{ url_for('search_page')}}" id="index-search" class="search-link"><span class="search-icon"><img src="../static/Images/Icons/search (1).png" alt="" srcset=""></span>Search for Movies</a>
        
        <h3 class="dashboard-menu-title">Menu</h3>
    
        <ul class="dashboard-menu-list desktop-menu">
            {% for dict_item in sections %}
                <li class="dashboard-menu-li">
                    <a href="{{ sections[dict_item] }}" class="dashboard-menu-link"> 
                        <span class="dashboard-icon">
                            {% if dict_item == "Watched" %}
                                <img src="../static/Images/Icons/video.png" alt="dashboard icon">
                            {% elif dict_item == "Home" %}   
                                <img src="../static/Images/Icons/home.png" alt="dashboard-icon"> 
                            {% elif dict_item == "Favourites" %}
                                <img src="../static/Images/Icons/heart.png" alt="dashboard-icon">  
                            {% elif dict_item == "Currently Watching" %}
                                <img src="../static/Images/Icons/cinema.png" alt="dashboard-icon">  
                            {% elif dict_item == "Watchlist" %}
                                <img src="../static/Images/Icons/movie.png" alt="dashboard-icon"> 
                            {% elif dict_item == "Recommendations" %}
                                <img src="../static/Images/Icons/feedback.png" alt="dashboard-icon">  
                            {% elif dict_item == "Movie Buddies" %}
                                <img src="../static/Images/Icons/happy.png" alt="dashboard-icon">  
                            {% endif %}                                              
                        </span>
                        {{ dict_item }}
                    </a>
                </li>
        
            {% endfor %}

                     
        </ul>

    </div>
       
    <div class="user-content">
        {% if home_page %}
        <div class="home-section">
            <div class="home-info">
                <h1 class="home-title"> Hi üëã, {{user_profile['full_name']}} </h1>
                <p>This is <span class="app-title">Movie Notes!</span> 
                <br>An app that enables you to keep track of your movie-watching experiences. With Movie Notes, you can easily organize your movie notes into sections: <span class="app-info-span">Watched, Currently Watching, Favourites,</span> and your <span class="app-info-span">Watchlist.</span></p>
                <h3 class="app-instruction-title"> To get started: </h3>
                <ol class="app-instruction-list">
                    <li class="app-instruction">Click on the ‚ÄúSearch for Movies‚Äù link on the left for desktop or search icon <img src="../static/Images/Icons/search.png" class="app-guide-icon-search"> at the top for mobile devices to search for movies.</li>
                    <li class="app-instruction">A search bar will appear where you can type in a movie title.</li>
                    <li class="app-instruction">For each search result, you‚Äôll see three dots <img src="../static/Images/Icons/9022327_dots_three_duotone_icon.png" alt="" class="app-guide-icon"> on the right . Click on them to reveal a menu with options to add the movie to one of your Movie Notes sections.</li>
                    <li class="app-instruction">After adding movies, you can find them in the corresponding sections of the Menu.On desktop, the Menu is located on the left side of your screen. On mobile, it‚Äôs at the top for easy access.</li>
                                                            
                </ol>
                
                <h4 class="app-instruction-subtitle"> Discover More</h4>
                <p class="movie-buddie-instruction">You can connect with friends on the app, known as ‚ÄúMovie Buddies.‚Äù Chat with them, share your movie-watching experiences, and recommend movies to each other.</p>
                <p> Now you're all set! Dive in, explore, and have fun keeping track of your movies! </p>
               
            </div>
            <div class="home-img">
                <img src="../static/Images/Icons/film-slate.png" alt="">
                
            </div>

            
            
        </div>
        {% endif%}

        {% if search_page %}
            <input  autocomplete="off" autofocus placeholder="Search for Movies to add to your Movie Notes"  type="text" id="searchInput" class="search-input">

            <h3 class="search-history" id="search-history"></h3>
            <div class="movieList"></div>
            <p style="display: none;" id="search-options-list">{{ json_buddynotes_options }}</p>

            <script>
                let timeoutId = null;
                let input = document.querySelector('input');
                input.addEventListener('input', function() {
                    clearTimeout(timeoutId);
                    timeoutId = setTimeout(async function() {
                        console.log("input")

                        // clear input field
                        document.querySelector(".movieList").innerHTML = '';
                        let response = await fetch('/search?q=' + input.value);
                        let movies = await response.json();
                        for (let id in movies) {
                            let title = movies[id].title.replace('<', '&lt;').replace('&', '&amp;');
                            console.log(title)
                            let year = movies[id].year;
                            let stars = movies[id].stars;
                            let poster = movies[id].poster;
                            let posterset = movies[id].posterset;
                            let movie_container_div = document.createElement("div");
                            movie_container_div.className = "movie-info-container";
                            let movie_info_text = document.createElement("div");
                            movie_info_text.className = "movie_info_text";
                            let movie_info_div = document.createElement("div")
                            movie_info_div.className = "movie-info"
                            let movie_title = document.createElement("h3");
                            movie_title.className = "search-movie-title";
                            movie_title.innerHTML = title;
                            let movie_year = document.createElement("p");
                            movie_year.className = "movie-year";
                            movie_year.innerHTML = year;
                            let movie_stars = document.createElement("p");
                            movie_stars.className = ("movie-stars");
                            movie_stars.innerHTML = stars;
                            let controls = document.createElement("img");
                            controls.className = "search-controls";
                            controls.id = "search-controls-options";
                            controls.src = "../static/Images/Icons/9022327_dots_three_duotone_icon.png";
                            let controls_btn = document.createElement("button");
                            controls_btn.type = "button";
                            controls_btn.className = "controls-btn";
                            controls_btn.appendChild(controls);

                            let movie_poster_div = document.createElement("div");
                            movie_poster_div.className= ("movie-poster-div")
                            let movie_poster = document.createElement("img");
                            movie_poster.src = poster;
                            movie_poster.sizes = "50vw, (min-width: 480px) 34vw, (min-width: 600px) 26vw, (min-width: 1024px) 16vw, (min-width: 1280px) 16vw";
                            movie_poster.srcset = posterset;
                        
                            movie_poster_div.appendChild(movie_poster);
                            movie_info_text.appendChild(movie_title);
                            movie_info_text.appendChild(movie_year);
                            movie_info_text.appendChild(movie_stars);
                            movie_info_div.appendChild(movie_info_text);
                            movie_info_div.appendChild(controls_btn);
                        
                            movie_container_div.appendChild(movie_poster_div);
                            movie_container_div.appendChild(movie_info_div);
                        
                            document.querySelector(".movieList").appendChild(movie_container_div);
                        
                        }
                    }, 300);

                    let search = document.getElementById("searchInput");
                    console.log("Search is:" + search.value)
                
                    console.log
                
                    if (document.getElementById("searchInput").value == ""){
                            console.log("search input is empty")
                            let search_history = document.getElementById("search-history");
                            search_history.innerHTML = "Recent searches";
                        }
                    else {
                        let search_history = document.getElementById("search-history");
                        search_history.innerHTML = "";
                    }    
                
                
                });

            </script>

            <script>
            let ids_for_recommendies = [];     // This list is being defined here to store ids for recommendie buddies. It is in outer scope to retain state  
           
            let isPopupVisible = false;
            let popup_menu;
            let popup_menu_div;

            document.addEventListener('click', function(event) {
                console.log(event.target);
                
                if (event.target.matches('.search-controls')) {
                    let event_trigger = event.target;
                   
                    console.log("options button clicked");
                    if(isPopupVisible && !popup_menu.contains(event.target)) {
                        //remove popup menu
                        popup_menu.remove();
                        isPopupVisible = false;
                    }

                    else {
                            popup_menu_div = document.createElement("div");
                            popup_menu_div.className = "popup-menu-wrapper";
                            popup_menu = document.createElement("ul");
                            popup_menu.className = "popup_menu-list";
                            let options_list = JSON.parse(document.getElementById('search-options-list').innerText);
                            console.log(options_list)

                            let options = {}
                            options_list.forEach(list_item => {
                                options[list_item[0]] = list_item[1]
                            });
                            console.log(options)

                            let search_list_options = [];
                            for (let key in options) {
                                let popup_options = document.createElement("li");
                                popup_options.className = "popup-menu-li";
                                let link = document.createElement("a");
                                link.href = options[key];
                                link.innerHTML = key;
                                popup_options.appendChild(link);
                                popup_menu.appendChild(popup_options);
                                search_list_options.push(popup_options);
                            }

                            popup_menu_div.appendChild(popup_menu);
                            event.target.parentNode.parentNode.parentNode.insertAdjacentElement('afterend', popup_menu_div);
                            isPopupVisible = true;

                            // Create elements to add a watched date
                            let watched_date = null;
                            let date_div = document.createElement("div");
                            date_div.className = 'date-div';
                            let date_lbl = document.createElement("label");
                            let date = document.createElement("input");
                            date_lbl.innerHTML = "Include date";
                            date.type = "date";
                            date.id = "watched-date"
                            date_div.appendChild(date_lbl);
                            date_div.appendChild(date);
                            date_div.style.display = "none"
                            popup_menu.insertAdjacentElement('afterend', date_div);

                            search_list_options.forEach(list_option => {
                                //console.log(list_option.firstChild.innerHTML)
                                if(list_option.firstChild.innerHTML == "Add to Watched") {
                                    console.log("Watched found")
                             
                                    list_option.addEventListener('mouseover', function() {
                                        date_div.style.display = "block";
                                       
                                    });

                                    date_div.addEventListener('mouseover', function() {
                                        date_div.style.display = "block";
                                    });

                                    date_div.addEventListener('mouseout', function() {
                                        date_div.style.display = "none";
                                    });

                               }
                            })

                            // Create a pop up menu for recommending movie for movie buddies
                            let buddy_recommendations_div = document.createElement('div');
                            buddy_recommendations_div.className = 'buddy_recommendations_div';
                            buddy_recommendations_div.id = 'recommendations_options';
                            let recommend_btn = document.createElement('button');
                            recommend_btn.innerHTML = 'Recommend';
                            recommend_btn.id = "recommend_btn";
                            let close_recommend = document.createElement('button');
                            close_recommend.className = "close-recommend";
                            let close_img = document.createElement('img');
                            close_img.src = "../static/Images/Icons/close.png";
                            close_img.id = "recommendations-close-btn";
                            let recommendations = document.createElement('div');
                            recommendations.className = 'recommendations-div';

                            close_recommend.appendChild(close_img);
                            buddy_recommendations_div.appendChild(close_recommend);
                            buddy_recommendations_div.appendChild(recommendations);
                            buddy_recommendations_div.appendChild(recommend_btn);
                            buddy_recommendations_div.style.display = "none";
                            event_trigger.parentNode.parentNode.parentNode.nextElementSibling.insertAdjacentElement('afterend', buddy_recommendations_div)
                            console.log(event_trigger.parentNode.parentNode.parentNode.nextElementSibling);
                                             
                                  







                            //Add event handlers to all links in the list items to send data to the server side
                            for(let i = 0; i < search_list_options.length; i++) {
                                search_list_options[i].firstChild.addEventListener('click', function(event) {
                                    event.preventDefault();
                                    console.log(event.target)
                                    console.log("search list option is:", search_list_options[i].firstChild.innerText)
                                    

                                    if(search_list_options[i].firstChild.innerText == "Recommend to Buddy") {
                                        console.log("Search list option found")
                                        fetch("/buddy_recommend_info")
                                        .then(response => {
                                           // Convert the response to JSON
                                           return response.json(); 
                                        })
                                        .then(recommend_to => {
                                            //Process the JSON data
                                            console.log(recommend_to);
                                            document.querySelector(".recommendations-div").innerHTML = '';
                                            popup_menu_div.style.display = "none";
                                            buddy_recommendations_div.style.display = "block";
                                        
                                            recommend_to.forEach(data_item => {
                                                console.log(data_item);
                                                let recommendie_wrapper = document.createElement('div');
                                                recommendie_wrapper.className = "recommendie_wrapper";

                                                let checkbox_div = document.createElement('div');
                                                checkbox_div.className = "checkbox-div";

                                                let checkbox = document.createElement('input');
                                                checkbox.className = 'checkbox';
                                                checkbox.type = 'checkbox';
                                                checkbox_div.appendChild(checkbox);
                                                // Add click event listner to the checkboxes
                                               
                                                checkbox.addEventListener('change', function(event) {
                                                    let item = event.target;
                                                    let data_item = item.parentNode.nextElementSibling.children[1].children[0].innerText;
                                                    console.log(item);
                                                    if(item.checked) {
                                                        console.log("checkbox checked");
                                                        console.log(data_item);
                                                        ids_for_recommendies.push(data_item);
                                                        console.log("click event added to checkbox")
                                                    }
                                                    else {
                                                        console.log("checkbox unchecked");
                                                        let index = ids_for_recommendies.indexOf(data_item);
                                                        if(index !== -1) {
                                                            ids_for_recommendies.splice(index, 1)
                                                        }


                                                    }
                                                    console.log(ids_for_recommendies);

                                                                                                        
                                                });

                                                
                                                let recommendie_div = document.createElement('div');
                                                recommendie_div.className = 'recommendie_div';

                                                let recommendie_profile = document.createElement('div');
                                                recommendie_profile.className = 'recommendie_profile_div';

                                                let profile_pic = document.createElement('img');
                                                profile_pic.className = 'recommendie_profile_pic';
                                                profile_pic.src = data_item.profile_pic;
                                                recommendie_profile.appendChild(profile_pic);

                                                let recommendie_info = document.createElement('div');
                                                recommendie_info.className = 'recommendie_info';

                                                let recommendie_id = document.createElement('p');
                                                recommendie_id.className = "recommendie-id";
                                                recommendie_id.innerText = data_item.id;
                                                recommendie_id.style.display = 'none';

                                                let recommendie_name = document.createElement('p');
                                                recommendie_name.className = 'recommendie-name';
                                                recommendie_name.innerText = data_item.full_name;

                                                let recommendie_username = document.createElement('p');
                                                recommendie_username.className = 'recommendie_username';
                                                recommendie_username.innerText = data_item.user_name;

                                                // append elements to the recommendie_info div
                                                recommendie_info.appendChild(recommendie_id);
                                                recommendie_info.appendChild(recommendie_name);
                                                recommendie_info.appendChild(recommendie_username);

                                                // append recommendie_profile and recommendie_info to recommendie_div
                                                recommendie_div.appendChild(recommendie_profile);
                                                recommendie_div.appendChild(recommendie_info);

                                                //append recommendie_div and checkbox to recommendie_wrapper
                                                recommendie_wrapper.appendChild(checkbox_div);
                                                recommendie_wrapper.appendChild(recommendie_div);
                                        
                                                // append recommendie_wrapper to recommendations
                                                recommendations.appendChild(recommendie_wrapper);

                                                




                                            })
                                        
                                        })
                                        .catch(error => {
                                            // Handle any errors that occurred during the fetch
                                            console.error('There was a problem with the fetch operation:', error);
                                        });

                                        close_img.addEventListener('click', function(event) {
                                            buddy_recommendations_div.style.display = "none";
                                            popup_menu_div.style.display = "flex";
                                        });

                                       


                                        

                                     
                                        
                                    }
                                    
                                    

                                    
                                        
                                    else {
                                        let data = {
                                        movie_title: event.target.parentNode.parentNode.parentNode.previousElementSibling.lastElementChild.firstElementChild.children[0].innerHTML,
                                        movie_year: event.target.parentNode.parentNode.parentNode.previousElementSibling.lastElementChild.firstElementChild.children[1].innerHTML,
                                        movie_stars: event.target.parentNode.parentNode.parentNode.previousElementSibling.lastElementChild.firstElementChild.children[2].innerHTML,
                                        movie_poster: event.target.parentNode.parentNode.parentNode.previousElementSibling.firstElementChild.firstChild.src,
                                        movie_poster_sizes: event.target.parentNode.parentNode.parentNode.previousElementSibling.firstElementChild.firstChild.sizes,
                                        movie_poster_set: event.target.parentNode.parentNode.parentNode.previousElementSibling.firstElementChild.firstElementChild.srcset
                                                                       
                                        };
                             

                                    if (search_list_options[i].firstChild.innerHTML == "Add to Watched") {
                                        data.date = watched_date;
                                    }
                                    console.log(data);   

                                        let link_element = search_list_options[i].firstChild
                                        console.log(link_element)
                                        let route = link_element.getAttribute('href')
                                        console.log(route)

                                        fetch(route, {
                                            method: 'POST',
                                            headers: {
                                            'Content-Type': 'application/json'
                                            },
                                        body: JSON.stringify(data)
                                        })
                                        .then(response=> response.json())
                                        .then(data => {
                                            alert(data.message);
                                            popup_menu_div.style.display = "none";
                                        })
                                        .catch((error) => console.error('Error:', error));
                                        }

                                    });
                            }  
                            
                            function upDateWatchedDate() {
                                    watched_date = date.value;
                            }
                                    
                            date.addEventListener('change', function(event) {
                                console.log("date changing")
                                upDateWatchedDate();
                                console.log(watched_date);
                                console.log(event.target);

                                console.log("Watched fetch function after date change")
                                let data = {
                                    movie_title: event.target.parentNode.parentNode.previousElementSibling.lastElementChild.firstElementChild.children[0].innerHTML,
                                    movie_year: event.target.parentNode.parentNode.previousElementSibling.lastElementChild.firstElementChild.children[1].innerHTML,
                                    movie_stars: event.target.parentNode.parentNode.previousElementSibling.lastElementChild.firstElementChild.children[2].innerHTML,
                                    movie_poster: event.target.parentNode.parentNode.previousElementSibling.firstElementChild.firstChild.src,
                                    movie_poster_sizes: event.target.parentNode.parentNode.previousElementSibling.firstElementChild.firstChild.sizes,
                                    movie_poster_set: event.target.parentNode.parentNode.previousElementSibling.firstElementChild.firstElementChild.srcset,
                                    date: watched_date                                   
                                }

                                console.log("data for watched date is:", data)
                                
                                fetch("/watched", {
                                method: 'POST',
                                headers: {
                                         'Content-Type': 'application/json'
                                        },
                                body: JSON.stringify(data)
                                })
                                .then(response=> response.json())
                                .then(data => {
                                    alert(data.message);
                                    popup_menu_div.style.display = "none";

                                })
                                .catch((error) => console.error('Error:', error));
                            });
                            watched_date = null;

                    }
                    
                }
            }); 
            let isEventListenerAdded = false;
            if(!isEventListenerAdded) {
                document.addEventListener('click', function(event) {
                console.log("Event target ID:", event.target.id);
                console.log("ids_for_recommendies length:", ids_for_recommendies.length); 

                if(event.target.id == "recommend_btn" && ids_for_recommendies.length >= 1) {
                    console.log("Recommended movie to be sent to server")
                    // data to be sent to the server
                    let data = {
                        movie_title: event.target.parentNode.previousElementSibling.previousElementSibling.children[1].firstElementChild.children[0].innerText,
                        movie_year: event.target.parentNode.previousElementSibling.previousElementSibling.children[1].firstElementChild.children[1].innerText,
                        movie_stars: event.target.parentNode.previousElementSibling.previousElementSibling.children[1].firstElementChild.children[2].innerText,
                        movie_poster: event.target.parentNode.previousElementSibling.previousElementSibling.children[0].firstElementChild.src,
                        movie_poster_sizes: event.target.parentNode.previousElementSibling.previousElementSibling.children[0].firstElementChild.sizes,
                        movie_poster_set: event.target.parentNode.previousElementSibling.previousElementSibling.children[0].firstElementChild.srcset,
                        recommendies: ids_for_recommendies
                    }

                    console.log(data);
                    console.log(ids_for_recommendies);
                    console.log("recommendie id not empty")
                    // Send data to server
                    fetch("/recommend_movie", {
                        method:'POST',
                        headers: {
                            'Content-Type':'application/json'
                        },
                        body: JSON.stringify(data)
                    })
                    .then(response => response.json())
                    .then(data => {
                        alert(data.message)
                        let element_to_hide = document.getElementById("recommendations_options");
                        console.log(element_to_hide);
                        element_to_hide.style.display = "none";
                    })
                    .catch((error) => console.log('Error:',error));
                    data = {};
                    ids_for_recommendies = [];
                }

                else if (event.target.id == "recommend_btn" && ids_for_recommendies.length == 0) {
                    console.log("None selected");
                    let element_to_hide = document.getElementById("recommendations_options");
                    console.log(element_to_hide);
                    element_to_hide.style.display = "none";
                
                }
            });
            isEventListenerAdded = true;
            }
            

            
        
            </script>
   



        {% endif %}

        <!-- This conditon displays watched movies -->
        {% if watched_section %}
            <div class="watched-section-wrapper">
                <div class="section-header">
                    <div class="section-header-img">
                        <img src="../static/Images/Icons/film-slate -header.png" alt="movie slate icon">
                    </div>
                    <div class="section-header-info">
                        <h1 class="section-title"> Movies Watced </h1>

                            <div>
                                {% if all_watched_movies %}
                                    <p class="section-total"><span id="watched-section-count">{{ movie|length }}</span> Movies Watched </p>   
                                {% elif watched_in_year %}  
                                    {% for year, count in count_of_movies_watched_inyear.items() %}
                                        <p class="section-total">{{ count }} Movies Watched In {{ year}}</p> 
                                    {% endfor %}    
                                {% endif %}                            
                            </div>
                        
                    </div>
                    

                </div>


                <div class="section-search-wrapper">                         
                    <input  autocomplete="off" autofocus placeholder="Search Your Watched Movies"  type="text" id="watched-movie-search" class="section-search">
                    <button id="search-close" style="display: none"><img src="../static/Images/Icons/close.png" alt="close search" ></button>
                </div>

                <div class="watched-view-btns">
                    <a href="/watched_section" id="all-watched-movies" class="watch-view-btn">All Watched Movies</a>
                    <a href="/watched_by_year" id="watched-by-year" class="watch-view-btn">Watched Movies by Year</a>
                </div>
                
           
                {% if all_watched_movies %} 
                <p style="display: none;" id="watched-options-list" class="movie_data_id">{{ json_watched_options }}</p>
                <div id="allwatched-movie-display" class="section-display">
                  
                    {% for dict_item in movie %}
                        <div class="movie-info-container section-info-container">
                            <p style="display: none;">{{dict_item["id"]}}</p>                                                      
                            <div class="movie-poster-div section-movie-poster-div">
                                <img src="{{dict_item['movie_poster']}}" alt="movie poster" sizes="{{dict_item['movie_poster_sizes']}}" srcset="{{dict_item['movie_poster_set']}}">
                            </div>
                            <div class="movie-info section-movie-info">
                                <div class="movie_info_text section-movie-info-text">
                                    <div class="movie_info_title_wrapper section-movie-info-wrapper">
                                        <h3 class="section-movie-title-no watched-section-title-no">{{ loop.index }}.</h3>
                                        <h3 class="section-movie-title">{{dict_item["movie_title"]}}</h3>
                                    </div>
                                    <p class="section-movie-year">{{dict_item["movie_year"]}}</p>
                                    <p class="section-movie-stars">{{dict_item["movie_stars"]}}</p>
                                </div>
                                <button type="button" class="controls-btn section-ctls">
                                    <img src="../static/Images/Icons/9022327_dots_three_duotone_icon.png" alt="" class="section-controls" id="watched-stn-ctls">
                                </button>
                            </div>

                        </div>                        
                    {% endfor %}
                </div>    
                {% endif %}    

                <div class="watched-year-movie-display" >
                    {% if watched_by_year or watched_in_year %}
                        <h3> Watched movies by year </h3>
                   
                    {% endif %}    

                {% if watched_by_year %}
                    <div class="movie-year-links">
                        {% for year in movie_watched_years %}
                            <form action="/watched_in_year" method="POST" class="watched-year-form">
                                <input type="hidden" name="watched_year" value="{{year['watched_year']}}">
                                <a href="#" class="watched-year-link">{{year["watched_year"]}}</a>
                            </form>
                        {% endfor %}   
                    </div>     
                {% elif watched_in_year %}  
                    <div class="movie-year-links">
                        {% for year in watched_years %}
                            <form action="/watched_in_year" method="POST" class="watched-year-form">
                                <input type="hidden" name="watched_year" value="{{year['watched_year']}}">
                                <a href="#" class="watched-year-link">{{year["watched_year"]}}</a>
                            </form>
                        {% endfor %} 
                    </div>   
                    {% endif %}    
                                        
                </div>

                <div id="watchedyear-movie-display">
                        
                    {% if watched_in_year %} 
                        <h3 class="section-sub-title">Movies watched in {{year_watched}}</h3>
                        {% for month in group_bymonth %}
                            <h3 class="month-title">{{month}}</h3>
                            <div class="month-movies-div">
                                {% for movie in group_bymonth[month] %}
                                    <div class="month-movie-container">
                                        <div class="month-movie-poster">
                                            <img src="{{movie['movie_poster']}}" alt="movie_poster" sizes="{{movie['movie_poster_sizes']}}" srcset="{{movie['movie_poster_set']}}">
                                        </div>
                                        <div class="month-movie-info">
                                            <div class="month-movie-title-div">
                                                <h4 class="month-movie-no">{{loop.index}}.</h4>
                                                <h4 class="month-movie-title">{{movie['movie_title']}}</h4>
                                            </div>
                                            <p class="month-movie-year">{{movie['movie_year']}}</p>
                                            <p class="month-movie-stars">{{movie['movie_stars']}}</p> 
                                        </div>

                                    </div>
                                {% endfor %}
                            </div>
                        {% endfor %}
                    {%endif%}    
                                       
                    
                </div>

                <div id="search-watched-wrapper" class="section-search-div" style="display: none;">
                    <p style="display: none;" id="watched-options-list" class="movie_data_id">{{ json_watched_options }}</p>
                </div>

            </div>
        

        {% endif %}


        <!-- This conditon displays favourite movies -->
        {% if favourite_section %}
            <div class="favourite-section-wrapper">
                <div class="section-header favourite-section-header">
                    <div class="section-header-img">
                        <img src="../static/Images/Icons/lover.png" alt="icon of a love heart">
                    </div>
                    <div class="section-header-info">
                        <h1 class="section-title"> Your Favourite Movies</h1>
                        <p class="section-total"><span id="favourites-section-count">{{ favourite_movies|length }}</span> Favourite Movies </p>    
                    </div>

                </div>
                
                                
                <div class="section-search-wrapper">
                    <input  autocomplete="off" autofocus placeholder="Search Your Favourite Movies"  type="search" id="favourite-movie-search" class="section-search">
                    <button id="search-close" style="display: none"><img src="../static/Images/Icons/close.png" alt="close search" ></button>
                </div>
              
               

                <p style="display: none;" id="favourite-options-list">{{ json_favourite_options }}</p>
            

                <div id="favourite-movie-display" class="section-display">
                    {% for dict_item in favourite_movies %}
                        <div class="movie-info-container">
                            <p style="display: none;" class="movie_data_id">{{dict_item["id"]}}</p>                                                      
                            <div class="movie-poster-div">
                                <img src="{{dict_item['movie_poster']}}" alt="movie poster" sizes="{{dict_item['movie_poster_sizes']}}" srcset="{{dict_item['movie_poster_set']}}">
                            </div>
                            <div class="movie-info">
                                <div class="movie_info_text">
                                    <div class="movie_info_title_wrapper">
                                        <h3 class="section-movie-title-no favourite-section-title-no">{{ loop.index }}.</h3>
                                        <h3 class="section-movie-title">{{dict_item["movie_title"]}}</h3>
                                    </div>
                                    <p class="section-movie-year">{{dict_item["movie_year"]}}</p>
                                    <p class="section-movie-stars">{{dict_item["movie_stars"]}}</p>
                                </div>
                                <button type="button" class="controls-btn">
                                    <img src="../static/Images/Icons/9022327_dots_three_duotone_icon.png" alt="" class="section-controls" id="favourite-stn-ctls">
                                </button>
                            </div>

                        </div>

                    {% endfor %}

                </div>

                <div id="search-favourites-wrapper" class="section-search-div">

                </div>

                
            </div>
        

        {% endif %}

        
        <!-- This section will display currently-watching movies -->
        {% if currently_watching %}
            <div class="currently-watching-section-wrapper">
                <div class="section-header currently-watching-section-header">
                    <div class="section-header-img">
                        <img src="../static/Images/Icons/watch.png" alt="illustration icon of people sitting on sofa watching tv">
                    </div>
                    <div class="secction-header-info">
                        <h1 class="section-title"> Movies You Are Currently Watching</h1>
                        <p class="section-total"><span id="currently-watching-count">{{ currently_watching_movies|length }}</span> Movies You are currently watching </p>
                    </div>

                </div>
                   
                <div class="section-search-wrapper">
                    <input  autocomplete="off" autofocus placeholder="Search Your Currently Watching"  type="search" id="currentlyWatching-movie-search" class="section-search">
                    <button id="search-close" style="display: none"><img src="../static/Images/Icons/close.png" alt="close search" ></button>
                </div>
                    

                <p style="display: none;" id="currentlywatching-options-list">{{ json_currently_watching_options }}</p>

                <div id="currentlywatching-movie-display" class="section-display">
                    {% for dict_item in currently_watching_movies %}
                        <div class="movie-info-container">
                            <p style="display: none;" class="movie_data_id">{{dict_item["id"]}}</p>                                                      
                            <div class="movie-poster-div">
                                <img src="{{dict_item['movie_poster']}}" alt="movie poster" sizes="{{dict_item['movie_poster_sizes']}}" srcset="{{dict_item['movie_poster_set']}}">
                            </div>
                            <div class="movie-info">
                                <div class="movie_info_text">
                                    <div class="movie_info_title_wrapper">
                                        <h3 class="section-movie-title-no currently-watching-movie-count">{{ loop.index }}.</h3>
                                        <h3 class="section-movie-title">{{dict_item["movie_title"]}}</h3>
                                    </div>
                                    <p class="section-movie-year">{{dict_item["movie_year"]}}</p>
                                    <p class="section-movie-stars">{{dict_item["movie_stars"]}}</p>
                                </div>
                                <p class="section-route" style="display: none;">Currently Watching</p>
                                <button type="button" class="controls-btn">
                                    <img src="../static/Images/Icons/9022327_dots_three_duotone_icon.png" alt="" class="section-controls" id="currentlywatching-stn-ctls">
                                </button>
                            </div>

                        </div>

                    {% endfor %}
                </div>

                <div id="search-currentlyWatching-wrapper" class="section-search-div">

                </div>
            </div>
        {% endif %}  
        
        
        <!-- This section will display movies in watchlist -->
        {% if watchlist %}
            <div class="watchlist-section-wrapper">
                <div class="section-header watchlist-section-header">
                    <div class="section-header-img">
                        <img src="../static/Images/Icons/watching-a-movie (1).png" alt="">
                    </div>
                    <div class="section-header-info">
                        <h2 class="section-title"> Your Watch List </h2>
                        <p class="section-total"><span id="watchlist-count">{{ movies_in_watchlist|length }}</span> Movies in your Watch List </p>
                    </div>
                  
                </div>
                                   
                <div class="section-search-wrapper">
                    <input  autocomplete="off" autofocus placeholder="Search Your Watch List"  type="search" id="watchlist-movie-search" class="section-search">
                    <button id="search-close" style="display: none"><img src="../static/Images/Icons/close.png" alt="close search" ></button>
                </div>
                  

               

                <p style="display: none;" id="watchlist-options-list">{{ json_watchlist_options }}</p>

                <div id="watchlist-movie-display" class="section-display">
                    {% for dict_item in movies_in_watchlist %}
                        <div class="movie-info-container">
                            <p style="display: none;" class="movie_data_id">{{dict_item["id"]}}</p>                                                      
                            <div class="movie-poster-div">
                                <img src="{{dict_item['movie_poster']}}" alt="movie poster" sizes="{{dict_item['movie_poster_sizes']}}" srcset="{{dict_item['movie_poster_set']}}">
                            </div>
                            <div class="movie-info">
                                <div class="movie_info_text">
                                    <div class="movie_info_title_wrapper">
                                        <h3 class="section-movie-title-no watchlist-movie-count">{{ loop.index }}.</h3>
                                        <h3 class="section-movie-title">{{dict_item["movie_title"]}}</h3>
                                    </div>
                                    <p class="section-movie-year">{{dict_item["movie_year"]}}</p>
                                    <p class="section-movie-stars">{{dict_item["movie_stars"]}}</p>
                                </div>
                                <p class="section-route" style="display: none;">Watch List</p>
                                <button type="button" class="controls-btn">
                                    <img src="../static/Images/Icons/9022327_dots_three_duotone_icon.png" alt="" class="section-controls" id="watchlist-stn-ctls">
                                </button>
                            </div>

                        </div>

                    {% endfor %}
                </div>

                <div id="search-watchlist-wrapper" class="section-search-div">

                </div>
            </div>
        {% endif %}  
        
        
        <!-- This section will display movie recommendations -->
        {% if recommendations_section %}
        <div class="recommendations-section-wrapper">
            <div class="section-header recommendations-section-header">
                <div class="section-header-img">
                    <img src="../static/Images/Icons/recommend.png" alt="illustration of a thumb up" srcset="">
                </div>
                <div class="section-header-info">
                    <h1 class="section-title">Movie Recommendations For You </h1>
                    <div id="recommendations-movie-display" >
                        {% if recommendations|length == 0 %}
                            <p> You dont have any Movie Recommendations. Ask your movie buddies to recommend some. </p>
                        {% else %}    
                            <p><span id="recommendations-count">{{ recommendations|length }}</span> Movies Recommended To You From Movie Buddies</p>
                        {% endif %}   
                    </div>     
                </div>
            </div>
            
            

            <p style="display: none;" id="recommendations-sections-list">{{json_recommendations_options}}</p>

            
                
                {% for dict_item in recommendations %}
                    
                    <div class="recommendations-movie-container">
                        
                        <div class="recommended-movie-info-container">
                            <p style="display: none;" class="movie_data_id">{{dict_item["recommendation_id"]}}</p>                                                      
                            <div class="recommended-movie-poster-div">
                                <img src="{{dict_item['movie_poster']}}" alt="movie poster" sizes="{{dict_item['movie_poster_sizes']}}" srcset="{{dict_item['movie_poster_set']}}">
                            </div>
                            <div class="recommended-movie-info">
                                <div class="movie_info_text">
                                    <div class="movie_info_title_wrapper">
                                        <h3 class="section-movie-title-no recommendations-movie-count">{{ loop.index }}.</h3>
                                        <h3 class="section-movie-title">{{dict_item["movie_title"]}}</h3>
                                    </div>
                                    <p class="section-movie-year">{{dict_item["movie_year"]}}</p>
                                    <p class="section-movie-stars">{{dict_item["movie_stars"]}}</p>
                                </div>
                                
                                <button type="button" class="controls-btn">
                                    <img src="../static/Images/Icons/9022327_dots_three_duotone_icon.png" alt="" class="section-controls" id="recommendations-stn-ctls">
                                </button>
                            </div>
                        </div>
                        <div class="recommender-info">
                        <p class="recommender-title">Recommended by;</p>    
                        
                            <div class="recommender-div">
                                {% for user in dict_item["user_name"] %}
                                <div class="recommendie-info-div">
                                    <p style="display: none;" class="recommender_id">{{user["user_id"]}}</p>
                                    <div class="recommender-profile">
                                        <div class="recommender-profile-pic">
                                            <img src="{{user['profile_pic']}}" alt="recommender's profile pic">
                                        </div>
                                        <div class="recommender-info-text">
                                            <p class="recommender-username">{{user["user_name"]}}</p>  
                                        </div>
                                    </div>                      
                                </div>
                            {% endfor %}             
                            </div>
                        
                        </div>
                    </div>
                    {% endfor %}
               
        </div>


        {% endif %}  

        <!-- This section will display the movie buddies -->
         {% if movie_buddies_section %}
         <div class="moviebuddies-section-wrapper section-wrapper">
            <div class="section-header">
                <div class="section-header-img">
                    <img src="../static/Images/Icons/buddies_2.png" alt="movie slate icon">
                </div>
                <div class="movie-buddies-title-div">
                    <h1 class="section-title movie-buddies-stn-title"> Movie Buddies </h1>            
                </div>

            </div>
            
                      
            <div>
                
                <div class="section-search-wrapper">
                    <input  autocomplete="off" autofocus placeholder="Search for Movie Buddies"  type="search" id="movie-buddies-search" class="section-search">
                    <button id="search-close" style="display: none"><img src="../static/Images/Icons/close.png" alt="close search" ></button>
                </div>

                <div class="movie-buddy-ctls">
                    <a href="/view_movie_buddyrequests" class="movie-buddy-ctl">Movie Buddy Requests</a>
                    <a href="/buddy_chats" class="movie-buddy-ctl">Movie Buddies Chats </a>                 
                </div>

                <div id="movie-buddies-display" class="section-display">
                    <h3 class="section-sub-title"> Your Movie Buddies </h3>
                    {% for dict_item in movie_buddies_list %}

                        <a href="#" class="view-buddy-notes">
                            <div class="movie-buddies-container">
                                <div class="movie-buddies-profile">
                                    <img class="movie-buddies-pic" src="{{dict_item['profile_pic']}}" alt="user profile icon">
                                </div>
                                <div class="movie-buddies-info">
                                    <p class="movie-buddies-id" style="display: none;">{{dict_item["id"]}}</p>
                                    <p class="movie-buddies-name">{{dict_item["name"]}}</p>
                                    <p class="movie-buddies-username">{{dict_item["user_name"]}} <span class="movie-buddies-status">&#x2022 {{dict_item["buddy_status"]}}</span></p>
                                </div>
    
                            </div>
                        </a>
                        
                    {% endfor%}
                </div>

                <div id="search-moviebuddies-wrapper" class="section-search-div" style="display: none;">

                </div>
              

            </div>
           


         </div>
         {% endif %}


        <!-- This section will display the movie buddies requests -->
         {% if view_movie_buddyrequests %}
         <div class="movie-buddy-ctls">
            <a href="/movie_buddies_section" class="movie-buddy-nav-link">Movie Buddies</a>
            <a href="/buddy_chats" class="movie-buddy-nav-link">Movie Buddies Chats </a>                 
        </div>

         <h2>Movie buddy Requests </h2>
            {% if movie_buddy_requests_list|length == 0 %}
                <p>No Movie Buddy Requests</p>
            {% else %}
                   {% for dict_item in movie_buddy_requests_list %}
                        <div class="movie_buddyrequests_container">
                            <div class="movie-buddy-request-profile">
                                <img src="{{dict_item['profile_pic']}}" alt="user profile pic">
                            </div>
                            <div class="movie-buddy-request-info">
                                <p class="movie-buddyrequest-id" style="display: none;">{{dict_item["id"]}}</p>
                                <p class="movie-buddy-request-name">{{dict_item["name"]}}</p>
                                <p class="movie-buddy-request-username">{{dict_item["user_name"]}} <button class="accept-buddyrequest" id="accept_buddyrequest_btn">Accept Movie Buddy Request</button> <button class="decline-buddyrequest" id="decline_buddyrequest_btn">Decline Movie Buddy Request</button></p>
                            </div>

                        </div>
                    {% endfor %}   
            {% endif %}         

         {% endif %}

        <!-- This section will display the message chats --> 
        {% if buddy_chats %} 
        <div class="movie-buddy-ctls">
            <a href="/movie_buddies_section" class="movie-buddy-nav-link">Movie Buddies</a>
            <a href="/view_movie_buddyrequests" class="movie-buddy-nav-link">Movie Buddy Requests</a>                
        </div>
        <h2> Movie Buddy Chats </h2>
       
        <div class="chat-container-div">
            <div class="chat-nav" id="chat-nav">
                <div class="chats-header">
                    <h2 class="chats-header-title">Chats</h2>
                    <a href="#" id="newchat-btn" >New Chat</a>
                </div>
                
                <div>
                    
                    <div id="defaultchat-profile">
                    {%if buddy_chats %}   
                        {%for dict_item in chat_history_buddies%}
                        <a href="#" class="chatbuddy_link" id="chatwith_buddy">
                            <div class="chatbuddy_div">
                                <div class="chatbuddy_profile_div">
                                    <img src="{{dict_item['profile_pic']}}" alt="profile-pic" srcset="" class="chatbuddy_profile_pic">
                                </div>
                                <div class="chatbuddy_info">
                                    <p class="chatbuddy-id" style="display: none;">{{dict_item["id"]}}</p>
                                    <p class="chatbuddy-name">{{dict_item["full_name"]}}</p>
                                    <p class="chatbuddy_username">{{dict_item["user_name"]}}</p>

                                </div>
                            </div>
                        </a>
                        {%endfor%}
                    {% endif %}
                    </div>
                    <div id="newchatprofile-holder" style="display: none;">
                        <div class="new-chat-menu">
                            <a href="http://" id="close-chat-btn">Close New Chat</a>
                            <input type="search" name="chat-seacrch" id="buddy-chat-search" autocomplete="off" placeholder="Search for Movie Buddy">
                        </div>
                        <div id="newchatbuddies-profile-holder">

                        </div>

                    </div>
                </div>
           

            </div>
            <div class="chat-area" id="chat-area-div">
                <div class="chat-header" id="chat-area-header" style="display: none;">
                    
                </div>
                <div class="chat-display" id="chat-display">
                    <h2>Chat area</h2>
                    
                </div>
                <div class="type-chat" id="type-chat-div" style="display: none;">
                    <input type="text" placeholder="Type a message" id="type-msg-input" >
                    <a href="#" id="send-msg-btn" >Send</a>
                    <a href="#" ><img src="../static/Images/Icons/send-message.png" alt="send message icon" srcset="" id="send-msg-btn-icon"></a>
                    
                </div>

            </div>


        </div>

        {% endif %}


        <!-- This section will display the movie notes for your movie buddies -->
        {% if view_buddynotes %}
        
            <div class="movie_buddy_profile_container">
                    <div class="movie-buddyrequest-profile">
                        <img src="{{buddy_notes_info['profile_pic']}}" alt="user profile pic">
                    </div>
                    <div class="movie-buddyrequest-info">
                        <p class="movie-buddyrequest-id" id="buddy-notes-view-id" style="display: none;">{{buddy_notes_info["id"]}}</p>
                        <p class="movie-buddyrequest-name">{{buddy_notes_info["name"]}}</p>
                        <p class="movie-buddyrequest-username">{{buddy_notes_info["username"]}} </p>
                    </div>

            </div>
            
            <h2> View my Movie Notes </h2>   
            
            <ul class="buddy-notes-nav">
                <!--<li><a href="#" class="buddy-notes-nav-item" id="buddy-notes-watched">Watched</a></li>
                <li><a href="#" class="buddy-notes-nav-item" id="buddy-notes-favourites">Favourites</a></li>
                <li><a href="#" class="buddy-notes-nav-item" id="buddy-notes-currently-watching">Currently Watching</a></li>-->
                <li><a href="#" class="buddy-notes-nav-item" id="buddy-notes-watched" {% if not view_buddy_favourites and not view_buddy_currentlywatching %}class="active"{% endif %}>Watched</a></li>
                <li><a href="#" class="buddy-notes-nav-item" id="buddy-notes-favourites" {% if view_buddy_favourites %}class="active"{% endif %}>Favourites</a></li>
                <li><a href="#" class="buddy-notes-nav-item" id="buddy-notes-currently-watching" {% if view_buddy_currentlywatching %}class="active"{% endif %}>Currently Watching</a></li>
    
            </ul>

            <div class="buddy-notes-display">
           
            {%if view_buddy_watched or (not view_buddy_favourites and not view_buddy_currentlywatching and view_buddynotes) %}
            <p style="display: none;" id="buddynotes-options-list" class="buddy-notes-options">{{ json_buddynotes_options }}</p>
                <p class="buddy-notes-subtitle"> My Watched Movies</p>
                {% for dict_item in buddy_watched_notes %}
                    <div class="buddy-notes-container">
                        <p style="display: none;">{{dict_item["id"]}}</p>
                        <div class="buddy-notes-movieposter">
                            <img src="{{dict_item['movie_poster']}}" alt="movie poster" srcset="{{dict_item['movie_poster_set']}}">
                        </div>
                        <div class="buddy-notes-movieinfo">
                            <div class="buddy-notes-movieinfo-text">
                                <div class="buddy-notes-title-wrapper">
                                    <h3 class="buddy-notes-section-title-no">{{loop.index}}.</h3>
                                    <h3 class="buddy-notes-section-title">{{dict_item["movie_title"]}}</h3>
                                </div>
                                <p class="buddy-notes-movie-year">{{dict_item["movie_year"]}}</p>
                                <p class="buddy-notes-movie-stars">{{dict_item["movie_stars"]}}</p>          
                            </div>
                            <button type="button" class="controls-btn">
                                <img src="../static/Images/Icons/9022327_dots_three_duotone_icon.png" alt="" class="section-controls" id="buddy-watched-stn-ctls">
                            </button>
    
                        </div>

                    </div>
                
                {% endfor %}
            {% endif %}   

            {% if view_buddy_favourites %}
            <p style="display: none;" id="buddynotes-options-list" class="buddy-notes-options">{{ json_buddynotes_options }}</p>
                <p class="buddy-notes-subtitle"> My Favourite Movies </p>
                {% for dict_item in buddy_favourites_notes %}
                    <div class="buddy-notes-container">
                        <p style="display: none;">{{dict_item["id"]}}</p>
                        <div class="buddy-notes-movieposter">
                            <img src="{{dict_item['movie_poster']}}" alt="movie poster" srcset="{{dict_item['movie_poster_set']}}">
                        </div>
                        <div class="buddy-notes-movieinfo">
                            <div class="buddy-notes-movieinfo-text">
                                <div class="buddy-notes-title-wrapper">
                                    <h3 class="buddy-notes-section-title-no">{{loop.index}}.</h3>
                                    <h3 class="buddy-notes-section-title">{{dict_item["movie_title"]}}</h3>
                                </div>
                                <p class="buddy-notes-movie-year">{{dict_item["movie_year"]}}</p>
                                <p class="buddy-notes-movie-stars">{{dict_item["movie_stars"]}}</p>          
                            </div>
                            <button type="button" class="controls-btn">
                                <img src="../static/Images/Icons/9022327_dots_three_duotone_icon.png" alt="" class="section-controls" id="buddy-watched-stn-ctls">
                            </button>
    
                        </div>

                    </div>
                
                {% endfor %}
            {% endif %}   

            {% if view_buddy_currentlywatching %}
            <p style="display: none;" id="buddynotes-options-list" class="buddy-notes-options">{{ json_buddynotes_options }}</p>
                <p class="buddy-notes-subtitle">What I am Currently Watching </p>
                {% for dict_item in buddy_currentlywatching_notes %}
                    <div class="buddy-notes-container">
                        <p style="display: none;">{{dict_item["id"]}}</p>
                        <div class="buddy-notes-movieposter">
                            <img src="{{dict_item['movie_poster']}}" alt="movie poster" srcset="{{dict_item['movie_poster_set']}}">
                        </div>
                        <div class="buddy-notes-movieinfo">
                            <div class="buddy-notes-movieinfo-text">
                                <div class="buddy-notes-title-wrapper">
                                    <h3 class="buddy-notes-section-title-no">{{loop.index}}.</h3>
                                    <h3 class="buddy-notes-section-title">{{dict_item["movie_title"]}}</h3>
                                </div>
                                <p class="buddy-notes-movie-year">{{dict_item["movie_year"]}}</p>
                                <p class="buddy-notes-movie-stars">{{dict_item["movie_stars"]}}</p>          
                            </div>
                            <button type="button" class="controls-btn">
                                <img src="../static/Images/Icons/9022327_dots_three_duotone_icon.png" alt="" class="section-controls" id="buddy-watched-stn-ctls">
                            </button>
    
                        </div>

                    </div>
                
                {% endfor %}
            {% endif %}   
            </div>
      

        {% endif %}





    
    </div>

</div>

{% endblock %}